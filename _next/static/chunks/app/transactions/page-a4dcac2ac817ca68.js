(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[220],{92990:function(e,t,s){Promise.resolve().then(s.bind(s,76285))},76285:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return _}});var a,n=s(17821),l=s(28326),r=s(52590),i=s(2545),o=s(6299),c=s(33198),u=s(71444),d=s(53023),p=s(37521),m=s(51967),x=s(51028),h=s(77585),b=s(31914),f=s(57103),y=s(39138),j=s(36511);BigInt.prototype.toJSON=function(){return this.toString()};var v=s(21164),g=s(25858),k=s(58644),w=s(6011),N=s(46693),S=s(57706),P=s(41914),C=s(70268),K=s(81286),O=s(11910);function A(e){var t,s,a,l,u,x,h,f,y,j;let{decoded:v,setDecoded:A,preview:T,isApproved:B}=e,{connection:L}=(0,i.R)(),F=(0,p.useCompromisedContext)(),I=(0,m.useFeePayerContext)(),[_,R]=(0,c.useState)(""),[M,D]=(0,c.useState)(""),[E,U]=(0,c.useState)(""),[W,J]=(0,c.useState)(""),[q,Z]=(0,c.useState)(""),[H,Q]=(0,c.useState)(""),z=(0,c.useCallback)(()=>(A({...v,instructions:[(0,O.mH)(I.publicKey,new o.PublicKey(M),new o.PublicKey(q)),...v.instructions]}),!0),[v,M,I,q]),G=(0,c.useCallback)(()=>(A({...v,instructions:[...v.instructions,o.SystemProgram.transfer({fromPubkey:new o.PublicKey(_),toPubkey:new o.PublicKey(M),lamports:Math.round(parseFloat(E)*o.LAMPORTS_PER_SOL)})]}),!0),[v,_,M,E]),V=(0,c.useCallback)(async()=>{let e=new o.PublicKey(q),t=await (0,S.ih)(L,e);if(!t)return alert("Mint ".concat(q," not found")),!1;let s=(0,S.MO)(e,new o.PublicKey(_),!0),a=(0,S.MO)(e,new o.PublicKey(M),!0);return A({...v,instructions:[...v.instructions,(0,P.$B)(s,a,new o.PublicKey(_),Math.round(parseFloat(E)*10**t.decimals))]}),!0},[L,v,_,M,E,q]),Y=(0,c.useCallback)(async()=>{let e=[...v.instructions,...await (0,d.f2)(L,I.publicKey,new o.PublicKey(_),new o.PublicKey(M),new o.PublicKey(q))];return A({...v,instructions:e}),!0},[L,v,_,M,q]),$=(0,c.useCallback)(async()=>(A({...v,instructions:[...v.instructions,(0,C.zl)(new o.PublicKey(_),new o.PublicKey(H),C.aj.AccountOwner,new o.PublicKey(M))]}),!0),[v,_,H,M,T]),X=(0,c.useCallback)(async()=>{let e=[...v.instructions],t=(0,d._O)(L,I.publicKey.toBase58()),[s]=(0,k.findAssociatedTokenPda)(t,{mint:(0,w.ZL)(q),owner:(0,w.ZL)(M)}),[a]=(0,g.findTokenRecordPda)(t,{mint:(0,w.ZL)(q),token:s}),n=await t.rpc.getBalance(a),l=await t.rpc.getRent((0,g.getTokenRecordSize)());return console.info(n.basisPoints,l.basisPoints,Number(l.basisPoints)-Number(n.basisPoints)),Number(n.basisPoints)<Number(l.basisPoints)&&e.unshift(o.SystemProgram.transfer({fromPubkey:I.publicKey,toPubkey:(0,N.I)(a),lamports:Number(l.basisPoints)-Number(n.basisPoints)})),A({...v,instructions:e}),!0},[L,I,v,_,M,q]),ee=(0,c.useCallback)(async()=>{let e=[...v.instructions];return e.unshift(o.SystemProgram.transfer({fromPubkey:I.publicKey,toPubkey:new o.PublicKey(M),lamports:Math.round(+E*o.LAMPORTS_PER_SOL)})),A({...v,instructions:e}),!0},[L,I,v,M,E]),et=(0,c.useCallback)(()=>{let e=+E*o.LAMPORTS_PER_SOL;console.log(E+" - adding "+e+" to unbricked account");let t=[(0,K.Zu)(F.publicKey,I.publicKey,I.publicKey),...v.instructions];return e>0&&t.splice(1,0,o.SystemProgram.transfer({fromPubkey:I.publicKey,toPubkey:F.publicKey,lamports:e})),A({...v,instructions:t}),!0},[v,F.publicKey,I,E]),es=(0,c.useCallback)(()=>(A({...v,instructions:[...v.instructions,...(0,d.U)(F.publicKey,I.publicKey,Math.floor(parseFloat(E)*o.LAMPORTS_PER_SOL)||0)]}),!0),[v,F.publicKey,I,E]),[ea,en]=(0,c.useState)("");(0,c.useEffect)(()=>{U(""),J(""),R(""),D(""),Z(""),"unbrick"===ea&&U("0.005")},[ea]);let el=(0,c.useCallback)(()=>{en("")},[]),er=(0,c.useMemo)(()=>{switch(ea){case"create-ata":return(0,w.uO)(q);case"transfer-sol":return parseFloat(E)>0&&(0,w.uO)(_)&&(0,w.uO)(M);case"transfer-spl":return parseFloat(E)>0&&(0,w.uO)(_)&&(0,w.uO)(M)&&(0,w.uO)(q);case"transfer-nft":return(0,w.uO)(_)&&(0,w.uO)(M)&&(0,w.uO)(q);case"prepare-pnft-transfer":return(0,w.uO)(q)&&(0,w.uO)(M);case"fund-account":return(0,w.uO)(M)&&(parseInt(W)>=0||parseFloat(E)>0);case"set-authority-spl":return(0,w.uO)(_)&&(0,w.uO)(M);case"unbrick":return parseFloat(E)>=0;case"brick":return!0;default:return!1}},[ea,_,M,E,W,q]);return(0,n.jsxs)(r.AppModal,{title:"Add Instruction",buttonClassName:"btn-neutral",onShow:el,submitDisabled:!er,submitLabel:"Add",submit:()=>{switch(ea){case"create-ata":return z();case"transfer-sol":return G();case"transfer-spl":return V();case"transfer-nft":return Y();case"set-authority-spl":return $();case"prepare-pnft-transfer":return X();case"fund-account":return ee();case"unbrick":return et();case"brick":return es();default:return!1}},children:[(0,n.jsxs)("fieldset",{className:"flex items-center gap-2",children:[(0,n.jsx)("label",{children:"Instruction:"}),(0,n.jsxs)("select",{className:"border flex-1",value:ea,onChange:e=>en(e.target.value),children:[(0,n.jsx)("option",{value:"",disabled:!0,children:"Pick"}),(0,n.jsx)("option",{value:"create-ata",children:"Create Token Account"}),(0,n.jsx)("option",{value:"transfer-sol",children:"Transfer SOL"}),(0,n.jsx)("option",{value:"transfer-spl",children:"Transfer Tokens"}),(0,n.jsx)("option",{value:"transfer-nft",children:"Transfer NFT"}),(0,n.jsx)("option",{value:"set-authority-spl",children:"Set Authority Token Account"}),(0,n.jsx)("option",{value:"prepare-pnft-transfer",children:"Prepare pNFT Transfer"}),(0,n.jsx)("option",{value:"fund-account",children:"Fund Account"}),(0,n.jsx)("option",{value:"unbrick",children:"Unbrick"}),(0,b.gl)(null===(t=F.publicKey)||void 0===t?void 0:t.toBase58(),null===(s=I.publicKey)||void 0===s?void 0:s.toBase58(),B)&&(0,n.jsx)("option",{value:"brick",children:"Brick"})]})]}),("create-ata"===ea||"prepare-pnft-transfer"===ea)&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("fieldset",{className:"flex items-center gap-2",children:[(0,n.jsx)("label",{children:"Mint:"}),(0,n.jsxs)("select",{className:"border flex-1",value:q,onChange:e=>{Z(e.target.value)},children:[(0,n.jsx)("option",{value:"",disabled:!0,children:"Pick"}),null==T?void 0:T.addresses.filter(e=>"mint"===e.type).map(e=>(0,n.jsx)("option",{value:e.pubkey,children:(0,r.ellipsify)(e.pubkey)},e.pubkey))]})]}),(0,n.jsxs)("fieldset",{className:"flex items-center gap-2",children:[(0,n.jsx)("label",{children:"For:"}),(0,n.jsxs)("select",{className:"border flex-1",value:M,onChange:e=>{D(e.target.value)},children:[(0,n.jsx)("option",{value:"",disabled:!0,children:"Pick"}),(0,n.jsx)("option",{value:null===(a=F.publicKey)||void 0===a?void 0:a.toBase58(),children:"Compromised wallet"}),(0,n.jsx)("option",{value:null===(l=I.publicKey)||void 0===l?void 0:l.toBase58(),children:"Safe wallet"})]})]})]}),"set-authority-spl"===ea&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"bg-warning p-2",children:"Be careful! This may cause irreversible changes if transferred to a wallet you do not control. Proceed with caution."}),(0,n.jsxs)("fieldset",{className:"flex items-center gap-2",children:[(0,n.jsx)("label",{children:"Token Account:"}),(0,n.jsxs)("select",{className:"border flex-1",value:_,onChange:e=>R(e.target.value),children:[(0,n.jsx)("option",{value:"",disabled:!0,children:"Pick"}),null==T?void 0:T.addresses.filter(e=>"token-account"===e.type).map(e=>(0,n.jsx)("option",{value:e.pubkey,children:(0,r.ellipsify)(e.pubkey)},e.pubkey))]})]}),(0,n.jsxs)("fieldset",{className:"flex items-center gap-2",children:[(0,n.jsx)("label",{children:"From:"}),(0,n.jsxs)("select",{value:H,className:"border flex-1",onChange:e=>Q(e.target.value),children:[(0,n.jsx)("option",{children:"Other"}),(0,n.jsx)("option",{value:null===(u=F.publicKey)||void 0===u?void 0:u.toBase58(),children:"Compromised wallet"}),(0,n.jsx)("option",{value:null===(x=I.publicKey)||void 0===x?void 0:x.toBase58(),children:"Safe wallet"})]})]}),(0,n.jsxs)("fieldset",{className:"flex items-center gap-2",children:[(0,n.jsx)("label",{children:"To:"}),(0,n.jsxs)("select",{className:"border flex-1",value:M,onChange:e=>{D(e.target.value)},children:[(0,n.jsx)("option",{value:"",disabled:!0,children:"Pick"}),(0,n.jsx)("option",{value:null===(h=F.publicKey)||void 0===h?void 0:h.toBase58(),children:"Compromised wallet"}),(0,n.jsx)("option",{value:null===(f=I.publicKey)||void 0===f?void 0:f.toBase58(),children:"Safe wallet"})]})]})]}),("transfer-sol"===ea||"transfer-spl"===ea||"transfer-nft"===ea)&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("fieldset",{className:"flex items-center gap-2",children:[(0,n.jsx)("label",{children:"From:"}),(0,n.jsxs)("select",{className:"border flex-1",value:_,onChange:e=>{R(e.target.value)},children:[(0,n.jsx)("option",{value:"",disabled:!0,children:"Pick"}),(0,n.jsx)("option",{value:null===(y=F.publicKey)||void 0===y?void 0:y.toBase58(),children:"Compromised wallet"}),(0,n.jsx)("option",{value:null===(j=I.publicKey)||void 0===j?void 0:j.toBase58(),children:"Safe wallet"})]})]}),(0,n.jsxs)("fieldset",{className:"flex items-center gap-2",children:[(0,n.jsx)("label",{children:"To:"}),(0,n.jsx)("input",{className:"border flex-1",value:M,onChange:e=>{D(e.target.value)}})]}),"transfer-sol"!==ea&&(0,n.jsxs)("fieldset",{className:"flex items-center gap-2",children:[(0,n.jsx)("label",{children:"Mint:"}),(0,n.jsx)("input",{className:"border flex-1",value:q,onChange:e=>Z(e.target.value)})]}),(0,n.jsxs)("fieldset",{className:"flex items-center gap-2",children:[(0,n.jsx)("label",{children:"Amount:"}),(0,n.jsx)("input",{className:"border flex-1",type:"number",min:0,value:"transfer-nft"===ea?1:E,disabled:"transfer-nft"===ea,onChange:e=>U(e.target.value)})]})]}),"fund-account"===ea&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("fieldset",{className:"flex items-center gap-2",children:[(0,n.jsx)("label",{children:"From:"}),(0,n.jsx)("input",{className:"border flex-1",value:"Safe wallet",readOnly:!0})]}),(0,n.jsxs)("fieldset",{className:"flex items-center gap-2",children:[(0,n.jsx)("label",{children:"Account:"}),(0,n.jsxs)("select",{className:"border flex-1",value:M,onChange:e=>{D(e.target.value)},children:[(0,n.jsx)("option",{value:"",disabled:!0,children:"Pick"}),null==T?void 0:T.addresses.filter(e=>e.writable).sort((e,t)=>e.before.lamports-t.before.lamports).map(e=>(0,n.jsxs)("option",{value:e.pubkey,children:[(0,r.ellipsify)(e.pubkey)," (",e.before.lamports/o.LAMPORTS_PER_SOL," SOL)"]},e.pubkey))]})]}),(0,n.jsxs)("fieldset",{className:"flex items-center gap-2",children:[(0,n.jsx)("label",{children:"Bytes:"}),(0,n.jsx)("input",{className:"border flex-1",type:"tel",min:0,value:W,onChange:async e=>{J(e.target.value);let t=parseInt(e.target.value);t>=0&&U((await L.getMinimumBalanceForRentExemption(t)/o.LAMPORTS_PER_SOL).toString())}})]}),(0,n.jsx)("span",{children:"OR"}),(0,n.jsxs)("fieldset",{className:"flex items-center gap-2",children:[(0,n.jsx)("label",{children:"Amount:"}),(0,n.jsx)("input",{className:"border flex-1",type:"number",value:E,onChange:async e=>{U(e.target.value);let t=parseFloat(e.target.value);t>0&&J("")}})]})]}),"unbrick"===ea&&(0,n.jsxs)("fieldset",{className:"flex items-center gap-2",children:[(0,n.jsx)("label",{children:"Add SOL to use:"}),(0,n.jsx)("input",{className:"border flex-1",type:"number",step:.01,min:0,value:E,onChange:e=>U(e.target.value)})]}),"brick"===ea&&(0,n.jsxs)("fieldset",{className:"flex items-center gap-2",children:[(0,n.jsx)("desc",{children:"Account must be emptied before bricking"}),(0,n.jsx)("label",{children:"Remove SOL:"}),(0,n.jsx)("input",{className:"border flex-1",type:"number",min:0,value:E,onChange:e=>U(e.target.value)})]})]})}var T=s(90887).Buffer;function B(e){let{safe:t,compromised:s,ix:a,i:l,transaction:r,setTransaction:i}=e,u=(0,c.useCallback)(()=>i({...r,instructions:(0,O.pB)(r.instructions,a,-1)}),[r,a]),d=(0,c.useCallback)(()=>i({...r,instructions:(0,O.pB)(r.instructions,a,1)}),[r]),p=(0,c.useCallback)(()=>i({...r,instructions:r.instructions.filter((e,t)=>t!==a)}),[r]),m=(e,t)=>s=>i({...r,instructions:r.instructions.map((n,l)=>l===a?{...n,keys:n.keys.map((a,n)=>n===e?{pubkey:"pubkey"===t?new o.PublicKey(s.target.value):a.pubkey,isSigner:"isSigner"===t?s.target.checked:a.isSigner,isWritable:"isWritable"===t?s.target.checked:a.isWritable}:a)}:n)}),x=e=>()=>{var t;let s=o.Keypair.generate();i({...r,instructions:r.instructions.map(t=>({...t,keys:t.keys.map(t=>t.pubkey.equals(e)?{...t,pubkey:s.publicKey}:t)})),extraSigners:null===(t=r.extraSigners)||void 0===t?void 0:t.map(t=>t.publicKey.equals(e)?{keypair:s,publicKey:e}:t)})},b=(0,c.useMemo)(()=>(function(e){switch(e.programId.toBase58()){case o.SystemProgram.programId.toBase58():return function(e){let t=o.SystemInstruction.decodeInstructionType(e);switch(t){case"Allocate":return{type:t,...o.SystemInstruction.decodeAllocate(e)};case"Create":return{type:t,...o.SystemInstruction.decodeCreateAccount(e)};case"Transfer":return{type:t,...o.SystemInstruction.decodeTransfer(e)}}}(e);case o.StakeProgram.programId.toBase58():return function(e){let t=o.StakeInstruction.decodeInstructionType(e);if("Authorize"===t)return{type:t,...o.StakeInstruction.decodeAuthorize(e)}}(e);case o.ComputeBudgetProgram.programId.toBase58():return function(e){let t=o.ComputeBudgetInstruction.decodeInstructionType(e);switch(t){case"SetComputeUnitLimit":return{type:t,...o.ComputeBudgetInstruction.decodeSetComputeUnitLimit(e)};case"SetComputeUnitPrice":return{type:t,...o.ComputeBudgetInstruction.decodeSetComputeUnitPrice(e)}}}(e);case j.H_.toBase58():return function(e){let{keys:t,data:s}=e;return{...Object.entries(t).reduce((e,t)=>{let[s,a]=t;return{...e,[s]:Array.isArray(a)?a.map(e=>e.pubkey):null==a?void 0:a.pubkey}},{}),...s}}((0,y.Bb)(e));case j._u.toBase58():return function(e){let t=e.data.toString();console.info(t)}(e)}})(l),[l]);return(0,n.jsxs)("div",{className:"text-left w-full",children:[(0,n.jsx)("hr",{className:"mb-4 mt-4"}),(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[(0,n.jsxs)("b",{className:"flex-1",children:["Instruction #",a]}),(0,n.jsx)("button",{className:"btn btn-neutral",disabled:a<=0,onClick:u,children:"↑"}),(0,n.jsx)("button",{className:"btn btn-neutral",disabled:a>=r.instructions.length-1,onClick:d,children:"↓"}),(0,n.jsx)("button",{className:"btn",onClick:p,children:"\xd7"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("b",{children:"Program:"})," ",(0,n.jsx)(h.Q,{type:"account",value:l.programId})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("b",{children:"Accounts: "}),0===l.keys.length&&(0,n.jsx)("i",{children:"No accounts required"}),l.keys.length>0&&(0,n.jsxs)("div",{className:"grid grid-cols-[auto_1fr_auto_auto_auto] gap-2",children:[(0,n.jsx)("b",{children:"#"}),(0,n.jsx)("b",{children:"Pubkey"}),(0,n.jsx)("b",{children:"\uD83D\uDD04"}),(0,n.jsx)("b",{children:"Signer"}),(0,n.jsx)("b",{children:"Writable"}),l.keys.map((e,a)=>(0,n.jsxs)(c.Fragment,{children:[(0,n.jsx)("span",{children:a}),(0,n.jsx)("input",{className:"border flex-1",value:e.pubkey.toBase58(),onChange:m(a,"pubkey")}),e.isSigner&&e.pubkey.toBase58()!==(null==t?void 0:t.toBase58())&&e.pubkey.toBase58()!==(null==s?void 0:s.toBase58())?(0,n.jsx)("button",{onClick:x(e.pubkey),children:"\uD83D\uDD04"}):(0,n.jsx)("span",{}),(0,n.jsx)("input",{type:"checkbox",checked:e.isSigner,onChange:m(a,"isSigner")}),(0,n.jsx)("input",{type:"checkbox",checked:e.isWritable,onChange:m(a,"isWritable")})]},a))]})]}),(0,n.jsxs)("div",{className:"text-wrap break-all max-w-40 max-h-20 overflow-auto",children:[(0,n.jsx)("b",{children:"Data:"}),(0,n.jsx)("textarea",{rows:2,value:T.from(new Uint8Array(l.data)).toString("hex"),onChange:e=>{i({...r,instructions:r.instructions.map((t,s)=>s===a?{...t,data:T.from(e.target.value,"hex")}:t)})},className:"border block w-full p-2"})]}),b&&(0,n.jsxs)("div",{children:[(0,n.jsx)("b",{children:"Decoded:"}),(0,n.jsx)("pre",{className:"border w-full overflow-auto",children:JSON.stringify(b,null,2)})]})]})}function L(){var e,t,s,a,l,y,j,g;let k=(0,p.useCompromisedContext)(),{connection:w}=(0,i.R)(),N=(0,m.useFeePayerContext)(),S=(0,d.A_)({address:k.publicKey,feePayer:N.publicKey}),P=(0,r.useTransactionToast)(),[C,K]=(0,c.useState)(""),[T,L]=(0,c.useState)(""),[_,R]=(0,c.useState)({blockhash:"",instructions:[],signatures:[],extraSigners:[],version:0}),[M,D]=(0,c.useState)(),[E,U]=(0,c.useState)(),[W,J]=(0,c.useState)("");async function q(){if(k.publicKey&&N){if(!T||0==T.length){J("Error: Payload not defined"),K("");return}try{let{transaction:e,blockhash:t,lastValidBlockHeight:s,shouldRescue:a}=await (0,f.mL)(w,_,N,k.publicKey);_.instructions.some(e=>e.keys.some(e=>e.isSigner&&e.pubkey.equals(k.publicKey)))&&(e=await k.signTransaction(e)),a&&await (0,b._T)(N.publicKey.toBase58());let n=await (0,f.T7)(w,e);K(n),J(""),P(n,"sent"),await w.confirmTransaction({signature:n,blockhash:t,lastValidBlockHeight:s},"confirmed"),P(n,"confirmed")}catch(e){console.error(e),J(e.toString())}}}let Z=async function(e){L(e.target.value);try{let t=await (0,O.m4)(w,e.target.value,N.publicKey,[N.publicKey,k.publicKey]);R(t)}catch(e){console.error(e),J(e.toString())}};(0,c.useEffect)(()=>{_&&N.publicKey?(0,O.cA)(w,_,N.publicKey).then(e=>D(e)):D(void 0)},[_,N.publicKey]);let H=(0,b.gl)(null===(e=k.publicKey)||void 0===e?void 0:e.toBase58(),null===(t=N.publicKey)||void 0===t?void 0:t.toBase58(),null!==(l=S.data)&&void 0!==l&&l);return(0,n.jsx)("div",{className:"max-w-7xl",children:(0,n.jsxs)("div",{className:"space-y-4 mt-4",children:[(0,n.jsxs)("div",{className:"border p-2 flex flex-col gap-2",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold",children:"Step 1: Safe wallet"}),(0,n.jsx)("div",{children:"Connect your safe wallet for paying fees and rent"}),(0,n.jsx)(x.Z,{})]}),k.publicKey&&N.publicKey&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"border p-2 flex flex-col gap-2",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold",children:"Step 2: Payload"}),(0,n.jsxs)("div",{children:["Go to protocol website and copy the payload instead of signing the transaction. Check the ",(0,n.jsx)("i",{children:"help"})," section at the top to know how."]}),(0,n.jsx)("div",{className:"space-x-2"}),(0,n.jsx)("textarea",{name:"payload",rows:4,onChange:Z,className:"border w-full p-2",placeholder:"Paste the payload here"})]}),!!_&&N.publicKey&&(0,n.jsxs)("div",{className:"border p-2 flex flex-col gap-2 items-center",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold",children:"Step 3: Instructions"}),(0,n.jsx)("div",{children:"View and edit your transaction for advanced use cases"}),(0,n.jsx)(A,{decoded:_,setDecoded:R,preview:M,isApproved:null!==(y=S.data)&&void 0!==y&&y}),!_.instructions.length&&(0,n.jsx)("div",{children:(0,n.jsx)("i",{children:"No instructions found"})}),_.instructions.map((e,t)=>(0,n.jsx)(B,{compromised:k.publicKey,safe:N.publicKey,i:e,ix:t,transaction:_,setTransaction:R},t))]}),M&&(0,n.jsxs)("div",{className:"border p-2 flex flex-col gap-1",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold",children:"Step 4: Preview"}),(0,n.jsxs)("div",{children:["Units consumed: ",M.unitsConsumed]}),(0,n.jsx)("h4",{children:"Simulation result:"}),!M.err&&(0,n.jsx)("div",{className:"alert alert-success font-bold p-2 flex justify-center",children:"SUCCESS"}),M.err&&(0,n.jsxs)("div",{className:"alert alert-warning p-2 flex justify-center",children:[(0,n.jsx)("b",{children:"ERROR:"})," ",JSON.stringify(M.err,null,2)]}),(0,n.jsx)("div",{children:"Transaction logs:"}),(0,n.jsx)("textarea",{value:(M.logs||[]).join("\n"),rows:10,readOnly:!0,className:"border w-full p-2"})]}),M&&M.accounts&&(0,n.jsxs)("div",{className:"border p-2 flex flex-col gap-1",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold",children:"Step 5: Account Changes"}),(0,n.jsx)("p",{children:"This section shows the account changes that will be made by the transaction."}),(0,n.jsxs)("div",{className:"p-2 border border-yellow-500 rounded-lg bg-yellow-100 flex gap-4 items-center",children:[(0,n.jsx)(u.gJy,{className:"text-4xl"}),(0,n.jsx)("span",{className:"text-md",children:"Check the accounts receiving (in green) SOL or tokens show as authority YOUR safe wallet. If it's your compromised wallet and you know your wallet can be drained, or it's another wallet, DON'T execute the transaction this way or you may lose these tokens you're withdrawing."})]}),(0,n.jsx)("div",{className:"overflow-auto",children:(0,n.jsxs)("table",{className:"table border border-collapse border-spacing-0 rounded-none p-2 w-full",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Address"}),(0,n.jsx)("th",{children:"Program"}),(0,n.jsx)("th",{children:"Authority"}),(0,n.jsx)("th",{children:"Before"}),(0,n.jsx)("th",{children:"After"}),(0,n.jsx)("th",{children:"Change"}),(0,n.jsx)("th",{children:"Alerts"})]})}),(0,n.jsx)("tbody",{children:M.addresses.map(e=>{var t,s,a,l,r,i;return(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:(0,n.jsx)(h.Q,{type:"account",value:e.pubkey})}),(0,n.jsx)("td",{children:(0,n.jsx)(h.Q,{type:"account",value:e.owner})}),(0,n.jsx)("td",{children:(0,n.jsx)(h.Q,{type:"account",value:e.after.authority||e.before.authority})}),(0,n.jsx)("td",{children:"token-account"===e.type?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(F,{balance:e.before.tokenAmount,decimals:null===(t=e.mint)||void 0===t?void 0:t.decimals}),(0,n.jsx)(F,{balance:e.before.lamports,symbol:"SOL",small:!0})]}):(0,n.jsx)(F,{balance:e.before.lamports,symbol:"SOL"})}),!M.err&&(0,n.jsx)("td",{children:"token-account"===e.type?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(F,{balance:e.after.tokenAmount,decimals:null===(s=e.mint)||void 0===s?void 0:s.decimals}),(0,n.jsx)(F,{balance:e.after.lamports,symbol:"SOL",showDecimals:9,small:!0})]}):(0,n.jsx)(F,{balance:e.after.lamports,symbol:"SOL"})}),!M.err&&(0,n.jsx)("td",{className:"inline-flex flex-col gap-1",children:"token-account"===e.type?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(I,{from:e.before.tokenAmount,to:e.after.tokenAmount,decimals:null===(a=e.mint)||void 0===a?void 0:a.decimals}),(0,n.jsx)(I,{from:e.before.lamports,to:e.after.lamports,symbol:"SOL",small:!0})]}):(0,n.jsx)(I,{from:e.before.lamports,to:e.after.lamports,symbol:"SOL"})}),(0,n.jsxs)("td",{children:[!e.type&&!(null===(l=e.owner)||void 0===l?void 0:l.equals(o.SystemProgram.programId))&&e.after.lamports>e.before.lamports&&(0,n.jsx)(u.gJy,{color:"red",title:"SOL not arriving to safe wallet"}),"token-account"===e.type&&(null!==(j=e.after.tokenAmount)&&void 0!==j?j:0)>(null!==(g=e.before.tokenAmount)&&void 0!==g?g:0)&&((null===(r=e.after.authority)||void 0===r?void 0:r.toBase58())===(null===(i=N.publicKey)||void 0===i?void 0:i.toBase58())?(0,n.jsx)(u.FJM,{color:"green",title:"Tokens arriving to safe wallet"}):(0,n.jsx)(u.gJy,{color:"red",title:"Tokens not arriving to safe wallet"}))]})]},e.pubkey)})})]})})]}),(null==_?void 0:null===(s=_.extraSigners)||void 0===s?void 0:s.some(e=>!e.keypair))&&(0,n.jsx)("div",{className:"border p-2",children:(0,n.jsx)("div",{children:"This transaction requires another wallet to sign it so it cannot be sent."})}),W&&(0,n.jsx)("div",{className:"alert alert-warning",children:W}),(0,n.jsxs)("div",{className:"border p-2",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold",children:"Step 6: Send"}),(0,n.jsxs)("div",{className:"flex gap-2 items-center justify-start",children:[(0,n.jsx)("b",{children:"Send transaction as:"}),(0,n.jsxs)("select",{className:"select select-bordered flex-1",value:(null===(a=_.version)||void 0===a?void 0:a.toString())||"0",onChange:e=>{R({..._,version:"legacy"===e.target.value?"legacy":0})},children:[(0,n.jsx)("option",{value:"legacy",children:"Legacy"}),(0,n.jsx)("option",{value:"0",children:"Versioned"})]})]}),(0,n.jsx)("button",{className:"mt-4 btn btn-2xl btn-primary text-2xl w-full",disabled:!H||!M||!!(null==M?void 0:M.err),onClick:()=>void q(),children:"Send Transaction"}),!H&&(0,n.jsx)(v.Z,{}),(0,n.jsx)("div",{className:"space-x-2"})]})]})]})})}function F(e){let{balance:t=0,decimals:s=9,showDecimals:a=3,symbol:l="",small:r=!1}=e,i=new Intl.NumberFormat([],{maximumFractionDigits:a}),o=[i.format(t/10**s)];return l&&o.push(l),(0,n.jsx)("span",{className:"whitespace-nowrap block mb-1 ".concat(r&&"text-xs"),children:o.join(" ")})}function I(e){let{from:t=0,to:s=0,decimals:a=9,symbol:l="",small:r=!1}=e,i=new Intl.NumberFormat([],{signDisplay:"exceptZero"}),o=s-t;if(0===o)return null;let c=[i.format(o/10**a)];return l&&c.push(l),(0,n.jsx)("span",{className:"whitespace-nowrap block alert ".concat(o>0?"alert-success":"alert-warning"," py-0 px-2 ").concat(r&&"text-xs"),children:c.join(" ")})}function _(){return(0,n.jsxs)("div",{children:[(0,n.jsx)(r.AppHero,{title:"Transactions",subtitle:"Build custom transactions for your compromised wallet",HelpModal:R,children:(0,n.jsxs)("div",{className:"flex gap-2 items-center justify-center",children:[(0,n.jsx)("h2",{className:"text-md font-bold",children:"Compromised wallet:"}),(0,n.jsx)(l.N,{})]})}),(0,n.jsx)(L,{})]})}function R(){return(0,n.jsx)(r.AppModal,{title:"Transactions",buttonLabel:"?",buttonClassName:"btn-sm btn-circle btn-neutral text-xl",children:(0,n.jsxs)("div",{className:"text-left",children:[(0,n.jsxs)("div",{className:"p-2 border border-yellow-500 rounded-lg bg-yellow-100 flex gap-4 items-center",children:[(0,n.jsx)(u.gJy,{className:"text-4xl"}),(0,n.jsx)("span",{className:"text-md",children:"This is an advance feature and may end up moving assets to the wrong place. Use it at your own risk."})]}),(0,n.jsx)("div",{className:"my-2 italic text-lg",children:"Grab a transaction from a dApp and reconfigure it to move assets out of any protocol directly to your safe wallet."}),(0,n.jsx)("summary",{children:"Connect your compromised wallet and safe wallet at Step 1."}),(0,n.jsxs)("summary",{children:["Grab the payload from the website using Solflare wallet at Step 2."," ",(0,n.jsx)("a",{href:"https://youtu.be/4TLF_Qi154k?t=55",target:"_blank",children:"How?"}),(0,n.jsxs)("div",{className:"pl-4 italic text-sm",children:["Phantom does support the payload feature as well.",(0,n.jsx)("br",{}),"First, enable it from Settings > Developer Settings > Enable Copy Transaction.",(0,n.jsx)("br",{}),"Then, on the site you wanting to grab the payload, trigger the transaction prompt and you'll find the Copy Transaction button in the Advanced section."]})]}),(0,n.jsx)("summary",{children:"Add, move or delete instructions at Step 3, to make more advanced scenarios that would fail for bricked wallets or else. Also modify the accounts being used on each instruction to fix issues from the simulation."}),(0,n.jsx)("summary",{children:"ALWAYS check the result of the simulation at Step 4 and VERIFY the account changes are showing increments on accounts your SAFE wallet is the authority (for tokens), or the owner (for SOL). If any account is not owned by yourself and shows an increment, your tokens will land in the WRONG WALLET."}),(0,n.jsx)("summary",{children:"Send the transaction and approve on both wallets."}),(0,n.jsxs)("div",{className:"mt-2 p-2 border border-blue-500 rounded-lg bg-blue-100 flex gap-4 items-center",children:[(0,n.jsx)(u.DAO,{className:"text-4xl"}),(0,n.jsx)("span",{className:"text-md",children:"Don't hesitate to reach out to us if you have any questions."})]})]})})}(a||(a={})).PioneerLegends="PioneerLegends"}},function(e){e.O(0,[942,449,210,842,665,143,138,331,622,322,62,744],function(){return e(e.s=92990)}),_N_E=e.O()}]);